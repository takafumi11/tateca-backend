# Common Configuration (All Environments)

spring.application.name=tateca-backend

# Database Configuration
spring.datasource.url=jdbc:mysql://${MYSQLHOST}:${MYSQLPORT}/${MYSQLDATABASE}?serverTimezone=UTC
spring.datasource.username=${MYSQLUSER}
spring.datasource.password=${MYSQLPASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Firebase Configuration
firebase.serviceAccountKey=${FIREBASE_SERVICE_ACCOUNT_KEY}
firebase.project.id=${FIREBASE_PROJECT_ID}

# External API Configuration
exchange.rate.api-key=${EXCHANGE_RATE_API_KEY}
exchange.rate.base-url=https://v6.exchangerate-api.com/v6

# Lambda/EventBridge API Key Configuration
lambda.api.key=${LAMBDA_API_KEY}

# Server Configuration
server.port=${PORT:8080}

# JPA Configuration
spring.jpa.hibernate.ddl-auto=none
spring.jpa.open-in-view=true

# Flyway Configuration
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration

# Virtual Threads Configuration (Java 21+)
spring.threads.virtual.enabled=true

# Resilience4j Retry Configuration
resilience4j.retry.instances.exchangeRateApi.max-attempts=3
resilience4j.retry.instances.exchangeRateApi.wait-duration=1s
resilience4j.retry.instances.exchangeRateApi.enable-exponential-backoff=true
resilience4j.retry.instances.exchangeRateApi.exponential-backoff-multiplier=2
resilience4j.retry.instances.exchangeRateApi.retry-exceptions=org.springframework.web.client.RestClientException

# SpringDoc OpenAPI Configuration (Code-First approach)
# Environment-specific overrides:
# - Development: Enabled for local API exploration
# - Production: Disabled (use GitHub Pages for documentation)
# - CI/CD: Enabled for automatic spec generation
springdoc.api-docs.path=/v3/api-docs
springdoc.api-docs.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=${SWAGGER_UI_ENABLED:false}
springdoc.show-actuator=true
springdoc.default-produces-media-type=application/json
springdoc.default-consumes-media-type=application/json

# Actuator Configuration
management.endpoints.web.exposure.include=health
management.endpoint.health.show-details=never
management.health.defaults.enabled=true
# Disable DB health check for fast liveness probe (Railway cold sleep prevention)
management.health.db.enabled=false
